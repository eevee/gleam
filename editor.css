ul, ol {
    margin: 0;
    padding: 0;
    list-style: none;
}

html {
    height: 100%;
}
/* FIXME grid sizing is very uncooperative */
body {
    display: grid;
    grid-template:
        "assets steps player" 1fr
        "assets steps roles" 1fr
        /* Grid columns seem to default to a minimum width of min-content, so
         * using minmax(0, ...) will force the script column to shrink if
         * necessary (which it is, because the twiddle debug panel HAS to
         * scroll horizontally) */
        / fit-content(10%) minmax(0, 1fr) min-content
    ;
    height: 100%;
    width: 100vw;
    margin: 0;

    background: #404040;
    color: white;
    font-family: 'Source Sans Pro', Helvetica, sans-serif;
    font-size: 14px;
}

.gleam-editor-overlay {
    position: fixed;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    color: black;
}
.gleam-editor-arg-enum-poses {
    position: absolute;
    min-width: 8em;
    border: 1px solid black;
    box-shadow: 0 0 3px #0009;
}
.gleam-editor-arg-enum-poses li {
    background: white;
    padding: 0.25em 0.5em;
    cursor: pointer;
}
.gleam-editor-arg-enum-poses li:hover {
    background: #e8e8e8;
}

/* Panels, which the entire editor UI is made of */
section.gleam-editor-panel {
    display: flex;
    flex-direction: column;
    border: 2px solid #101010;
}
section.gleam-editor-panel > header {
    flex: 0;
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin: 0;
    padding: 0.33em 0.5em;
    background: #202020;
}
section.gleam-editor-panel > header h1 {
    flex: 0 0 auto;
    margin: 0;
}
section.gleam-editor-panel > header nav {
    flex: 0 0 auto;
    display: flex;
    margin: 0;
}
section.gleam-editor-panel > .gleam-editor-panel-body {
    position: relative;
    /* Note the flex-basis here has to be zero, or the body's contents will be considered large enough to expand the grid beyond the height of the page viewport! */
    /* FIXME can i hoist this up a level and make it the grid cell's problem? */
    flex: 1 0 0;
    overflow: auto;
}
section.gleam-editor-panel > footer {
    /* TODO this was a bit of a half-baked idea and isn't done yet */
    position: relative;
    flex: 0 1 auto;
    overflow: auto;
    border-top: 1px solid #101010;
}
#gleam-editor-player {
    grid-area: player;
}
#gleam-editor-roles {
    grid-area: roles;
}
#gleam-editor-assets {
    grid-area: assets;
}
#gleam-editor-script {
    grid-area: steps;
}

body > section.gleam-editor-drag-hover {
    border-color: hsl(210, 50%, 6.25%);
    background-color: hsl(210, 50%, 25%);
}
body > section.gleam-editor-drag-hover > header {
    background-color: hsl(210, 50%, 12.5%);
}

/* TODO super can't get away with this for long */
nav button {
    margin: 0 0.25em;
    padding: 0.5em;
    line-height: 1em;
    border-radius: 3px;
    border: none;
    background: #606060;
    color: black;
}
nav button:hover {
    background: #808080;
}

/* Stage panel */
#gleam-editor-player {
    background: #303030;
}
#gleam-editor-player > .gleam-editor-panel-body {
    flex: 1;
    padding: 1em;
    overflow: visible;
}
#gleam-editor-player .gleam-player {
    margin: auto;
}

/* Roles panel */
ol.gleam-editor-roles {
}
ol.gleam-editor-roles > li {
    margin: 0.5em;
    border: 1px solid #202020;
    background: white;
    color: #202020;
}
ol.gleam-editor-roles > li h2 {
    padding: 0.25em 0.5em;
    margin: 0;
    font-size: 1.25em;
    background: hsl(0, 0%, 75%);
}
ol.gleam-editor-roles > li h3 {
    margin: 0.5em 0 0;
    padding: 0.125em 0.5em;
    border-bottom: 2px solid #404040;
    font-weight: normal;
    font-size: 1.2em;
}
ul.gleam-editor-role-pictureframe-poses {
    margin: 0.5em;
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
}
ul.gleam-editor-role-pictureframe-poses li {
}
ul.gleam-editor-role-pictureframe-poses .-asset {
    display: block;
    max-width: 100px;
    max-height: 100px;
    margin: 0 auto;
}
ul.gleam-editor-role-pictureframe-poses .-asset.--missing {
    line-height: 100px;
    background-color: #fcc;
    text-align: center;
    color: #400;
}
ul.gleam-editor-role-pictureframe-poses .-caption {
    font-size: 0.83em;
    margin: 0.5rem 0;
    font-family: "Source Code Pro", Inconsolata, monospace;
    text-align: center;
}

/* Asset panel */
.gleam-editor-assets li {
    padding: 0.25em 0.5em;
}
.gleam-editor-assets li.--missing {
    background: #803838;
}
.gleam-editor-assets li.--unused {
    color: #c0c0c0;
    font-style: italic;
}

/* Script panel */
#gleam-editor-script {
    /* Need this for positioning the drag caret */
    position: relative;
}
ol.gleam-editor-beats-list {
    /* Need this for positioning the numbers */
    position: relative;
    margin: 0.5em 1em;
    padding: 0;

    /* make room for numbers */
    padding-left: 1.5em;
    counter-reset: beat;
}
ol.gleam-editor-beats-list > li {
    margin: 0.5em 0;
    border: 1px solid #202020;
    box-shadow: 0 0.125em 0.25em #202020;
}
ol.gleam-editor-beats-list > li::before {
    counter-increment: beat;
    content: counter(beat);
    display: block;
    position: absolute;
    font-size: 0.75em;
    width: 1.5rem;
    margin-left: -2rem;
    text-align: right;
}
/* Step currently showing on stage */
ol.gleam-editor-beats-list > li.--current {
    outline: 2px solid hsl(45, 100%, 50%);
}
ol.gleam-editor-beats-list > li.--current .gleam-editor-step {
    background-color: hsl(45, 100%, 90%);
}

/* TODO ditch this...?  is there any other use for it? */
.gleam-editor-beat-toolbar {
    position: absolute;
    /* needs to be above the items */
    z-index: 1;
    font-size: 0.5em;
    padding: 0.33em;
    /* must match the right margin on the beat list */
    right: 1em;
    /* FIXME this fucking sucks, i want to align the BOTTOM to a TOP edge */
    transform: translateY(-100%);
    border: 1px solid black;
    border-bottom: none;
    border-top-right-radius: 3px;
    border-top-left-radius: 3px;
    background: black;
}
.gleam-editor-step-caret {
    position: absolute;
    z-index: 99;
    margin: 0;
    margin-top: -2px;  /* overlap the border */
    left: 0;
    right: 0;
    height: 3px;
    border: none;
    background: hsl(210, 90%, 60%);
}
.gleam-editor-step-caret.--mid-beat {
    /* Half of the margin between beats */
    margin-top: calc(-0.5em + 2px);
}

/* Script footer -- shows the state for each actor on a beat */
#gleam-editor-script > footer {
    display: flex;
    overflow: auto;
}
.gleam-editor-script-role-state {
    flex: 0;
    margin: 0.5em;
    background: #ccc;
    color: #202020;
}
.gleam-editor-script-role-state h2 {
    font-size: 1em;
    margin: 0;
    padding: 0.33em;
    background: #d0d0d0;
}
.gleam-editor-script-role-state dl {
    font-size: 0.83em;
    display: grid;
    grid-template-columns: min-content 0.5em 1fr;
    margin: 0.33em;
    width: 16rem;
    font-family: "Source Code Pro", Inconsolata, monospace;
}
.gleam-editor-script-role-state dt {
    grid-column: 1;
    color: #606060;
    text-align: right;
}
.gleam-editor-script-role-state dd {
    grid-column: 3;
    margin: 0;
    width: 12em;
    white-space: nowrap;
    text-overflow: ellipsis;
    overflow: hidden;
}

/* Steps, used in roles and the script panel */
.gleam-editor-step {
    display: flex;
    background: #f0f0f0;
    color: #202020;
}
.gleam-editor-step.gleam-editor--dragged-step {
    opacity: 0.5;
}
.gleam-editor-step + .gleam-editor-step {
    border-top: 1px solid #808080;
}
.gleam-editor-step > .-handle {
    padding: 0.25em;
    background: #a0a0a0;
    color: #c0c0c0;
    text-shadow: 0 1px 1px #606060;
    cursor: move;
}
.gleam-editor-step > .-who {
    z-index: 1;
    padding: 0.25em 0.5em;
    padding-right: 1em;
    background: hsl(0, 0%, 75%);
    border-top-right-radius: 0.75em 1em;
    border-bottom-right-radius: 0.75em 1em;
}
.gleam-editor-step > .-what {
    padding: 0.25em 0.5em;
    padding-right: 1em;
    background: hsl(0, 0%, 82.5%);
    border-top-right-radius: 0.75em 1em;
    border-bottom-right-radius: 0.75em 1em;
}
.gleam-editor-step > .-who + .-what {
    padding-left: 1.5em;
    margin-left: -1em;
}
.gleam-editor-step > .-how {
    flex: 1;
    display: flex;
    flex-direction: column;
}
.gleam-editor-step > .-how > * {
    padding: 0.25em 0.5em;
}

/* Step arguments */
/* FIXME consistent hover and "is being edited" effect? */
.gleam-editor-arg-enum {
    color: #404fff;
    /* FIXME make this a more obvious click area */
    min-width: 2em;
    min-height: 1em;
    cursor: pointer;
}
.gleam-editor-arg-prose {
    position: relative;
    margin: 0 1em;
    white-space: pre-wrap;
}
/* This becomes a textarea when being edited, so style it like it weren't */
textarea.gleam-editor-arg-prose {
    display: block;
    font-family: inherit;
    font-size: inherit;
    border: none;
    background: none;
    height: auto;
}
/* FIXME oh fuck off, these don't work with a textarea */
.gleam-editor-arg-prose::before {
    content: '“';
    display: block;
    position: absolute;
    font-size: 2em;
    top: -0.25em;  /* rough alignment for Big Quote */
    left: -0.5rem;
}
.gleam-editor-arg-prose::after {
    content: '”';
    display: block;
    position: absolute;
    font-size: 2em;
    bottom: -0.5em;  /* rough alignment for Big Quote */
    right: -0.5rem;
}


/* Special styling for particular role types; applies to steps and to the
 * headers of their properties in the role list */
/* TODO maybe make these roles generic instead of needing to update this 
/* Stage */
.gleam-editor-step.gleam-editor-role-stage > .-who,
ol.gleam-editor-roles > li.gleam-editor-role-stage h2,
.gleam-editor-script-role-state.gleam-editor-role-stage h2 {
    background: hsl(0, 50%, 75%);
}
.gleam-editor-step.gleam-editor-role-stage > .-who::before,
ol.gleam-editor-roles > li.gleam-editor-role-stage h2::before,
.gleam-editor-script-role-state.gleam-editor-role-stage h2::before {
    content: '📻';
    margin-right: 0.25em;
}
/* Jukebox */
.gleam-editor-step.gleam-editor-role-jukebox > .-who,
ol.gleam-editor-roles > li.gleam-editor-role-jukebox h2,
.gleam-editor-script-role-state.gleam-editor-role-jukebox h2 {
    background: hsl(270, 50%, 75%);
}
.gleam-editor-step.gleam-editor-role-jukebox > .-who::before,
ol.gleam-editor-roles > li.gleam-editor-role-jukebox h2::before,
.gleam-editor-script-role-state.gleam-editor-role-jukebox h2::before {
    content: '📻';
    margin-right: 0.25em;
}
/* Picture frame */
.gleam-editor-step.gleam-editor-role-pictureframe > .-who,
ol.gleam-editor-roles > li.gleam-editor-role-pictureframe h2,
.gleam-editor-script-role-state.gleam-editor-role-pictureframe h2 {
    background: hsl(330, 50%, 75%);
}
.gleam-editor-step.gleam-editor-role-pictureframe > .-who::before,
ol.gleam-editor-roles > li.gleam-editor-role-pictureframe h2::before,
.gleam-editor-script-role-state.gleam-editor-role-pictureframe h2::before {
    content: '🖼️';
    margin-right: 0.25em;
}
/* Dialogue box */
.gleam-editor-step.gleam-editor-role-dialoguebox > .-who,
ol.gleam-editor-roles > li.gleam-editor-role-dialoguebox h2,
.gleam-editor-script-role-state.gleam-editor-role-dialoguebox h2 {
    background: hsl(60, 50%, 75%);
}
.gleam-editor-step.gleam-editor-role-dialoguebox > .-who::before,
ol.gleam-editor-roles > li.gleam-editor-role-dialoguebox h2::before,
.gleam-editor-script-role-state.gleam-editor-role-dialoguebox h2::before {
    content: '💬️';
    margin-right: 0.25em;
}
/* Character */
.gleam-editor-step.gleam-editor-role-character > .-who,
ol.gleam-editor-roles > li.gleam-editor-role-character h2,
.gleam-editor-script-role-state.gleam-editor-role-character h2 {
    background: hsl(210, 50%, 75%);
}
.gleam-editor-step.gleam-editor-role-character > .-who::before,
ol.gleam-editor-roles > li.gleam-editor-role-character h2::before,
.gleam-editor-script-role-state.gleam-editor-role-character h2::before {
    content: '🗣️';
    margin-right: 0.25em;
}
